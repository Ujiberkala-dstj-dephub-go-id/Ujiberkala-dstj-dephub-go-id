{"version":3,"file":"onoffcanvas.esm.js","sources":["../../src/constants.ts","../../src/util.ts","../../src/index.ts"],"sourcesContent":["export interface OcOptions {\n  createDrawer?: boolean;\n  hideByEsc?: boolean;\n}\n\nexport const NAME = \"onoffcanvas\";\nexport const EVENT_KEY = `.${NAME}`;\n\nexport const EventName = {\n  HIDE: `hide${EVENT_KEY}`,\n  SHOW: `show${EVENT_KEY}`,\n};\n\nexport const ClassName = {\n  SHOW: \"is-open\",\n};\n\nexport const Selector = {\n  DATA_TOGGLE: '[data-toggle=\"onoffcanvas\"]',\n};\n\nexport const OcDefault: OcOptions = {\n  createDrawer: true,\n  hideByEsc: true,\n};\n\nexport type OnoffCanvasEvents = \"show.onoffcanvas\" | \"hide.onoffcanvas\";\n","export function getSelectorFromElement(element: Element): string | null {\n  let selector = element.getAttribute(\"data-target\");\n  if (!selector || selector === \"#\") {\n    selector = element.getAttribute(\"href\") || \"\";\n  }\n  try {\n    const $selector = document.querySelectorAll(selector);\n    return $selector.length > 0 ? selector : null;\n  } catch (error) {\n    throw new Error(\"Target Not Found!\");\n  }\n}\n\nexport function selectorArray(arrs: any[]): any[] {\n  const divArr: string[] = [];\n  arrs.forEach((arr) => {\n    const selector = getSelectorFromElement(arr);\n    divArr.push(selector!);\n  });\n  return divArr;\n}\n\nexport function isElement(element: unknown): element is Element {\n  return Boolean((element as Element).classList);\n}\n","import {\n  ClassName,\n  EventName,\n  OcDefault,\n  OcOptions,\n  OnoffCanvasEvents,\n  Selector,\n} from \"./constants\";\nimport { isElement, selectorArray } from \"./util\";\n\n/**\n * @export\n * @class OnoffCanvas\n */\nexport default class OnoffCanvas {\n  public static attachTo(\n    element: HTMLElement | string,\n    options?: OcOptions,\n  ): OnoffCanvas {\n    return new OnoffCanvas(element, options);\n  }\n\n  /**\n   * Auto init all OnoffCanvas elements\n   *\n   * @static\n   * @param {boolean} [escKey]\n   * @memberof OnoffCanvas\n   */\n  public static autoinit(options = OcDefault) {\n    const ocNodeList = document.querySelectorAll(`${Selector.DATA_TOGGLE}`);\n\n    const ocListArr = [...ocNodeList];\n\n    const selectorArr = selectorArray(ocListArr);\n\n    const newOcArr = [...new Set(selectorArr)];\n    newOcArr.forEach((noa) => {\n      OnoffCanvas.attachTo(noa, options);\n    });\n  }\n\n  public element: Element;\n\n  public config: OcOptions;\n\n  private triggerElements: Element[];\n\n  private drawer: HTMLDivElement;\n\n  /**\n   * Creates an instance of OnoffCanvas.\n   *\n   * @constructor\n   * @param {Element | string} element\n   * @param {OcOptions} [options]\n   * @memberof OnoffCanvas\n   */\n  constructor(element: Element | string, options?: OcOptions) {\n    this.element = isElement(element)\n      ? element\n      : document.querySelector<HTMLElement>(element)!;\n    this.config = { ...OcDefault, ...options };\n\n    this.triggerElements = Array.from(\n      document.querySelectorAll<HTMLElement>(\n        `${Selector.DATA_TOGGLE}[href=\"#${this.element.id}\"],\n      ${Selector.DATA_TOGGLE}[data-target=\"#${this.element.id}\"]`,\n      ),\n    );\n\n    this.addAriaExpanded(this.triggerElements);\n\n    this.triggerElements.forEach((el: Element) => {\n      el.addEventListener(\"click\", (event) => {\n        const eventTarget = event.target as Element | null;\n        if (eventTarget && eventTarget.tagName === \"A\") {\n          event.preventDefault();\n        }\n        this.toggle();\n      });\n    });\n\n    this.drawer = document.createElement(\"div\");\n    this.drawer.classList.add(\"onoffcanvas-drawer\");\n  }\n\n  public on(event: OnoffCanvasEvents, handle: EventListener) {\n    this.listen(event, handle);\n    return this;\n  }\n\n  /**\n   * Show/Hide OnoffCanvas element\n   *\n   * @returns {void}\n   * @memberof OnoffCanvas\n   */\n  public toggle(): void {\n    if (this.element.classList.contains(ClassName.SHOW)) {\n      this.hide();\n    } else {\n      this.show();\n    }\n  }\n\n  /**\n   * Show OnoffCanvas element\n   *\n   * @returns {void}\n   * @memberof OnoffCanvas\n   */\n  public show(): void {\n    if (this.element.classList.contains(ClassName.SHOW)) {\n      return;\n    }\n    this.element.classList.add(ClassName.SHOW);\n    this.addAriaExpanded(this.triggerElements);\n    this.emit(EventName.SHOW, this.element);\n\n    if (this.config.createDrawer) {\n      document.documentElement.appendChild(this.drawer);\n      this.drawer.classList.add(\"is-open\");\n      this.drawer.addEventListener(\"click\", this.hide.bind(this));\n    }\n\n    if (this.config.hideByEsc) {\n      window.addEventListener(\"keydown\", (event) => {\n        if (event.key === \"Escape\") {\n          this.hide();\n        }\n      });\n    }\n  }\n\n  /**\n   * Hide OnoffCanvas element\n   *\n   * @returns {void}\n   * @memberof OnoffCanvas\n   */\n  public hide(): void {\n    if (!this.element.classList.contains(ClassName.SHOW)) {\n      return;\n    }\n\n    if (this.config.createDrawer) {\n      this.drawer.classList.remove(\"is-open\");\n      this.drawer.removeEventListener(\"click\", this.hide.bind(this));\n      document.documentElement.removeChild(this.drawer);\n    }\n\n    this.element.classList.remove(ClassName.SHOW);\n    this.addAriaExpanded(this.triggerElements);\n    this.emit(EventName.HIDE, this.element);\n  }\n\n  private listen(event: string, handle: EventListener) {\n    this.element.addEventListener(event, handle, false);\n    return this;\n  }\n\n  private emit<T extends object>(\n    evtType: string,\n    target: T,\n    shouldBubble = false,\n  ) {\n    const evt = new CustomEvent(evtType, {\n      detail: target,\n      bubbles: shouldBubble,\n    });\n\n    this.element.dispatchEvent(evt);\n    return this;\n  }\n\n  private addAriaExpanded(triggerElements: Element[]): void {\n    const isOpen = this.element.classList.contains(ClassName.SHOW);\n    triggerElements.forEach((tel) => {\n      tel.setAttribute(\"aria-expanded\", isOpen.toString());\n    });\n  }\n}\n"],"names":[],"mappings":"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"}