{"version":3,"names":["EventName","HIDE","SHOW","ClassName","Selector","OcDefault","createDrawer","hideByEsc","selectorArray","arrs","divArr","forEach","arr","selector","element","getAttribute","document","querySelectorAll","length","error","Error","getSelectorFromElement","push","OnoffCanvas","constructor","options","this","Boolean","classList","isElement","querySelector","config","Object","assign","triggerElements","Array","from","id","addAriaExpanded","el","addEventListener","event","eventTarget","target","tagName","preventDefault","toggle","drawer","createElement","add","static","selectorArr","Set","noa","attachTo","on","handle","listen","contains","hide","show","emit","documentElement","appendChild","bind","window","key","remove","removeEventListener","removeChild","evtType","shouldBubble","evt","CustomEvent","detail","bubbles","dispatchEvent","isOpen","tel","setAttribute","toString"],"sources":["../../src/constants.ts","../../src/util.ts","../../src/index.ts"],"sourcesContent":["export interface OcOptions {\n  createDrawer?: boolean;\n  hideByEsc?: boolean;\n}\n\nexport const NAME = \"onoffcanvas\";\nexport const EVENT_KEY = `.${NAME}`;\n\nexport const EventName = {\n  HIDE: `hide${EVENT_KEY}`,\n  SHOW: `show${EVENT_KEY}`,\n};\n\nexport const ClassName = {\n  SHOW: \"is-open\",\n};\n\nexport const Selector = {\n  DATA_TOGGLE: '[data-toggle=\"onoffcanvas\"]',\n};\n\nexport const OcDefault: OcOptions = {\n  createDrawer: true,\n  hideByEsc: true,\n};\n\nexport type OnoffCanvasEvents = \"show.onoffcanvas\" | \"hide.onoffcanvas\";\n","export function getSelectorFromElement(element: Element): string | null {\n  let selector = element.getAttribute(\"data-target\");\n  if (!selector || selector === \"#\") {\n    selector = element.getAttribute(\"href\") || \"\";\n  }\n  try {\n    const $selector = document.querySelectorAll(selector);\n    return $selector.length > 0 ? selector : null;\n  } catch (error) {\n    throw new Error(\"Target Not Found!\");\n  }\n}\n\nexport function selectorArray(arrs: any[]): any[] {\n  const divArr: string[] = [];\n  arrs.forEach((arr) => {\n    const selector = getSelectorFromElement(arr);\n    divArr.push(selector!);\n  });\n  return divArr;\n}\n\nexport function isElement(element: unknown): element is Element {\n  return Boolean((element as Element).classList);\n}\n","import {\n  ClassName,\n  EventName,\n  OcDefault,\n  OcOptions,\n  OnoffCanvasEvents,\n  Selector,\n} from \"./constants\";\nimport { isElement, selectorArray } from \"./util\";\n\n/**\n * @export\n * @class OnoffCanvas\n */\nexport default class OnoffCanvas {\n  public static attachTo(\n    element: HTMLElement | string,\n    options?: OcOptions,\n  ): OnoffCanvas {\n    return new OnoffCanvas(element, options);\n  }\n\n  /**\n   * Auto init all OnoffCanvas elements\n   *\n   * @static\n   * @param {boolean} [escKey]\n   * @memberof OnoffCanvas\n   */\n  public static autoinit(options = OcDefault) {\n    const ocNodeList = document.querySelectorAll(`${Selector.DATA_TOGGLE}`);\n\n    const ocListArr = [...ocNodeList];\n\n    const selectorArr = selectorArray(ocListArr);\n\n    const newOcArr = [...new Set(selectorArr)];\n    newOcArr.forEach((noa) => {\n      OnoffCanvas.attachTo(noa, options);\n    });\n  }\n\n  public element: Element;\n\n  public config: OcOptions;\n\n  private triggerElements: Element[];\n\n  private drawer: HTMLDivElement;\n\n  /**\n   * Creates an instance of OnoffCanvas.\n   *\n   * @constructor\n   * @param {Element | string} element\n   * @param {OcOptions} [options]\n   * @memberof OnoffCanvas\n   */\n  constructor(element: Element | string, options?: OcOptions) {\n    this.element = isElement(element)\n      ? element\n      : document.querySelector<HTMLElement>(element)!;\n    this.config = { ...OcDefault, ...options };\n\n    this.triggerElements = Array.from(\n      document.querySelectorAll<HTMLElement>(\n        `${Selector.DATA_TOGGLE}[href=\"#${this.element.id}\"],\n      ${Selector.DATA_TOGGLE}[data-target=\"#${this.element.id}\"]`,\n      ),\n    );\n\n    this.addAriaExpanded(this.triggerElements);\n\n    this.triggerElements.forEach((el: Element) => {\n      el.addEventListener(\"click\", (event) => {\n        const eventTarget = event.target as Element | null;\n        if (eventTarget && eventTarget.tagName === \"A\") {\n          event.preventDefault();\n        }\n        this.toggle();\n      });\n    });\n\n    this.drawer = document.createElement(\"div\");\n    this.drawer.classList.add(\"onoffcanvas-drawer\");\n  }\n\n  public on(event: OnoffCanvasEvents, handle: EventListener) {\n    this.listen(event, handle);\n    return this;\n  }\n\n  /**\n   * Show/Hide OnoffCanvas element\n   *\n   * @returns {void}\n   * @memberof OnoffCanvas\n   */\n  public toggle(): void {\n    if (this.element.classList.contains(ClassName.SHOW)) {\n      this.hide();\n    } else {\n      this.show();\n    }\n  }\n\n  /**\n   * Show OnoffCanvas element\n   *\n   * @returns {void}\n   * @memberof OnoffCanvas\n   */\n  public show(): void {\n    if (this.element.classList.contains(ClassName.SHOW)) {\n      return;\n    }\n    this.element.classList.add(ClassName.SHOW);\n    this.addAriaExpanded(this.triggerElements);\n    this.emit(EventName.SHOW, this.element);\n\n    if (this.config.createDrawer) {\n      document.documentElement.appendChild(this.drawer);\n      this.drawer.classList.add(\"is-open\");\n      this.drawer.addEventListener(\"click\", this.hide.bind(this));\n    }\n\n    if (this.config.hideByEsc) {\n      window.addEventListener(\"keydown\", (event) => {\n        if (event.key === \"Escape\") {\n          this.hide();\n        }\n      });\n    }\n  }\n\n  /**\n   * Hide OnoffCanvas element\n   *\n   * @returns {void}\n   * @memberof OnoffCanvas\n   */\n  public hide(): void {\n    if (!this.element.classList.contains(ClassName.SHOW)) {\n      return;\n    }\n\n    if (this.config.createDrawer) {\n      this.drawer.classList.remove(\"is-open\");\n      this.drawer.removeEventListener(\"click\", this.hide.bind(this));\n      document.documentElement.removeChild(this.drawer);\n    }\n\n    this.element.classList.remove(ClassName.SHOW);\n    this.addAriaExpanded(this.triggerElements);\n    this.emit(EventName.HIDE, this.element);\n  }\n\n  private listen(event: string, handle: EventListener) {\n    this.element.addEventListener(event, handle, false);\n    return this;\n  }\n\n  private emit<T extends object>(\n    evtType: string,\n    target: T,\n    shouldBubble = false,\n  ) {\n    const evt = new CustomEvent(evtType, {\n      detail: target,\n      bubbles: shouldBubble,\n    });\n\n    this.element.dispatchEvent(evt);\n    return this;\n  }\n\n  private addAriaExpanded(triggerElements: Element[]): void {\n    const isOpen = this.element.classList.contains(ClassName.SHOW);\n    triggerElements.forEach((tel) => {\n      tel.setAttribute(\"aria-expanded\", isOpen.toString());\n    });\n  }\n}\n"],"mappings":"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"}